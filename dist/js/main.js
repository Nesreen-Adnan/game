let container=document.querySelector(".container"),cards=document.querySelector(".cards"),wrongs=document.querySelector(".header .wrong-tries .wrongs"),timerSpan=document.querySelector(".timer .time"),nameSpan=document.querySelector(".header .name"),stopWindow=document.querySelector(".stop"),winWindow=document.querySelector(".win"),winTime=document.querySelector(".win .time"),resultsParent=document.querySelector(".win .results .parent"),buttons=[...document.querySelectorAll(".btn")],startBtn=document.querySelector(".start .btn"),againButtons=[...document.querySelectorAll(".btn.again")],getName=document.querySelector(".get-name"),nameInput=document.querySelector(".get-name input"),goBtn=document.querySelector(".get-name button"),audios={click:"sounds/click.mp3",stop:"sounds/bottles.mp3",button:"sounds/click-button.mp3",begain:"sounds/begain.mp3",win:"sounds/win.mp3",correct:"sounds/correct.mp3"};function sound(t){new Audio(audios[t]).play()}function rotation(){[...cards.children].forEach((t=>{t.addEventListener("click",(()=>{cards.dataset.opened<2&&(t.classList.add("rotation"),cards.dataset.opened++,sound("click")),2==cards.dataset.opened&&([...cards.children].forEach((e=>{e.dataset.src==t.dataset.src&&e.dataset.num!=t.dataset.num&&e.classList.contains("rotation")&&(t.classList.add("correct"),e.classList.add("correct"),sound("correct"))})),t.classList.contains("correct")||wrongs.textContent++,setTimeout((()=>{removeAll("rotation",[...cards.children]),cards.dataset.opened=0}),1200)),checkwin()}))}))}function createCards(){cards.innerHTML="";let t=["https://cdn.worldvectorlogo.com/logos/html-1.svg","https://cdn.worldvectorlogo.com/logos/typescript.svg","https://cdn.worldvectorlogo.com/logos/css-3.svg","https://cdn.worldvectorlogo.com/logos/vue-9.svg","https://cdn.worldvectorlogo.com/logos/gulp.svg","https://cdn.worldvectorlogo.com/logos/sass-1.svg","https://cdn.worldvectorlogo.com/logos/react-2.svg","https://cdn.worldvectorlogo.com/logos/java-14.svg"],e=[...t,...t],n=e.length;for(let t=0;t<n;t++){let o=Math.floor(Math.random()*(n-t)),a=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),c=document.createElement("img");a.classList.add("card","border","transition","relative"),a.dataset.num=t,a.dataset.src=e[o],a.dataset.soundonclick="click",s.classList.add("frontface","flex","abs"),s.textContent="?",a.appendChild(s),r.classList.add("backface","flex","abs"),c.src=`${e[o]}`,r.appendChild(c),a.appendChild(r),cards.appendChild(a),e.splice(o,1)}rotation()}function checkwin(){let t=0;[...cards.children].forEach((e=>{e.classList.contains("correct")&&t++})),t==cards.children.length&&win()}function win(){winTime.textContent=timerSpan.dataset.time-timerSpan.textContent,setToLocalStorage(),arrangeInfo(),showResults(),sound("win");let t=winWindow.scrollHeight-window.innerHeight;t>0&&(container.style.height=`${container.scrollHeight+t+250}px`),winWindow.classList.add("show")}function setToLocalStorage(){let t={name:nameSpan.textContent,time:winTime.textContent},e=JSON.parse(window.localStorage.getItem("players")),n=0;if(e){Array.isArray(e)||(e=[e]);for(let o=0;o<e.length;o++)e[o].name==nameSpan.textContent&&(e[o].time>winTime.textContent&&(t.time=winTime.textContent,e.splice(o,1),e.push(t)),n++);0==n&&e.push(t),window.localStorage.setItem("players",JSON.stringify(e))}else window.localStorage.setItem("players",JSON.stringify([t]))}function arrangeInfo(){let t=JSON.parse(window.localStorage.getItem("players")),e=[1],n=[1],o=[1],a=[1];for(let o=0;o<t.length;o++)0==o?(e=[t[o].time],n=[t[o].name]):(e.push(t[o].time),n.push(t[o].name));e=e.map((t=>+t));for(let n=0;n<t.length;n++){let t=Math.min(...e),a=e.indexOf(+t);0==n?o=[t]:o.push(t),e.splice(a,1)}t.forEach((t=>{t.taken=!1}));for(let e=0;e<t.length;e++)for(let n=0;n<t.length;n++)if(t[n].time==o[e]&&!t[n].taken){0==e?a=[t[n]]:a.push(t[n]),t[n].taken=!0;break}window.localStorage.setItem("players",JSON.stringify(a))}function showResults(){let t=JSON.parse(window.localStorage.getItem("players"));resultsParent.innerHTML="";for(let e=0;e<t.length;e++){let n=t[e],o=document.createElement("div"),a=document.createElement("div"),s=document.createElement("span"),r=document.createElement("div"),c=document.createElement("span"),i=document.createElement("span"),l=document.createElement("button");o.classList.add("result"),a.classList.add("text"),s.classList.add("num"),s.textContent=e+1,a.appendChild(s),r.classList.add("name"),r.textContent=n.name,a.appendChild(r),c.classList.add("win-time"),i.classList.add("time"),i.textContent=n.time,c.appendChild(i),c.append("s"),a.appendChild(c),o.appendChild(a),l.textContent="remove",l.onclick=()=>{o.remove(),t.splice(e,1),window.localStorage.setItem("players",JSON.stringify(t)),showResults(),container.scrollHeight>=window.innerHeight+30&&(container.style.height=container.scrollHeight-30+"px")},o.appendChild(l),resultsParent.appendChild(o)}}function stop(){let t=document.querySelector(".stop .wrongs");wrongs.textContent>1?t.textContent=`you have ${wrongs.textContent} wrong tries`:1==wrongs.textContent?t.textContent="you have one wrong try":t.textContent="you don't have any wrong try",sound("stop"),stopWindow.classList.add("show")}function startTimer(){timerSpan.textContent=timerSpan.dataset.time;let t=9,e=setInterval((()=>{winWindow.classList.contains("show")||(timerSpan.textContent>0?timerSpan.textContent>10?timerSpan.textContent--:timerSpan.textContent="0"+t--:(clearInterval(e),stop()))}),1e3)}function removeAll(t,e){e.forEach((e=>{e.classList.remove(t)}))}buttons.forEach((t=>t.addEventListener("click",(()=>sound("button"))))),createCards(),startBtn.addEventListener("click",(()=>{getName.classList.add("show"),nameInput.focus(),goBtn.addEventListener("click",(()=>{sound("begain"),goBtn.parentElement.parentElement.classList.add("hidden"),nameSpan.textContent=nameInput.value?nameInput.value:"unknown",startTimer()}))})),againButtons.forEach((t=>{t.addEventListener("click",(()=>{container.style.height=`${window.innerHeight}px`,removeAll(["rotation","correct"],[...cards.children]),stopWindow.classList.remove("show"),winWindow.classList.remove("show"),wrongs.textContent=0,createCards(),timerSpan.textContent=timerSpan.dataset.time,startTimer()}))}));